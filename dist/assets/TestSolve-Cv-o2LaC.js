import{j as e,r as x,a as I,B as L,c as A,e as Z,C as F,n as O,x as q,L as R}from"./index-BO880UDm.js";import{B as $}from"./Button-TXCx0WR2.js";import{M as W}from"./Modal-CexqlRwf.js";import{B as V}from"./Box-BOyM-UR1.js";import{T as M}from"./Typography-CKaXYeGi.js";import{d as ee}from"./index-DUt2ngVP.js";import{I as se}from"./IconButton-XmvcqOIy.js";import{C as te}from"./Close-BNY08pWz.js";import{c as G}from"./createSvgIcon-C7bB0SuN.js";import{N as ae,L as ne}from"./NavigateNext-DCYMRWZU.js";import{C as ie}from"./CircularProgress-DgyyXpUr.js";import{D as le}from"./Divider-0gXcqOwE.js";import{S as re}from"./ShortText-BKWxXDjF.js";import"./Portal-DVCdK67x.js";import"./index-Dyaj_eaP.js";import"./dividerClasses-B0CDf_Rv.js";const J=G(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),oe=G(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore");function de({questionSet:t=[],sectionId:a,testSubmissionId:h}){var i;const[s,g]=x.useState(0),[l,o]=x.useState({}),[b,y]=x.useState(new Set),[w,u]=x.useState(!1),[f,j]=x.useState(!1),r=t[s];x.useEffect(()=>{r!=null&&r._id&&y(n=>new Set(n).add(r._id))},[s,r]);const v=(n,d)=>{o(N=>({...N,[n]:d}))},c=n=>{var T;const d=((T=t[s])==null?void 0:T._id)===n,N=l[n],_=b.has(n);let S="p-2 border text-sm";return d?`${S} bg-blue-700 text-white border-blue-700`:N?`${S} bg-green-100 border-green-400 text-green-800`:_?`${S} bg-orange-100 border-orange-400 text-orange-800`:`${S} bg-red-100 border-red-400 text-red-800`},m=()=>{j(!1),u(!0),I.post(`${L}/api/v2/test/submit-section/${h}`,{sectionId:a,sectionType:"Quiz",quizAnswers:l},{withCredentials:!0}).then(()=>{j(!1),window.location.reload()}).catch(n=>{console.log(n),u(!1)})};return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-52px-70px)] lg:flex-row font-sans bg-white text-gray-800",children:[e.jsxs("div",{className:"flex-1 flex-col justify-between flex h-full p-5",children:[e.jsxs("div",{className:"border w-full border-gray-200 rounded-sm p-8 shadow-sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-2",children:["Question ",s+1," of ",t.length]}),e.jsx("p",{className:"text-base",children:r==null?void 0:r.question})]}),e.jsx("div",{className:"space-y-4",children:(i=r==null?void 0:r.answerOptions)==null?void 0:i.map(n=>{const d=l[r._id]===n._id;return e.jsxs("label",{className:`flex items-center border p-3 rounded-md cursor-pointer transition ${d?"border-blue-600 bg-blue-50":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",className:"mr-3",name:`question-${r._id}`,value:n._id,checked:d,onChange:()=>v(r._id,n._id)}),e.jsx("span",{className:"text-sm",children:n.text})]},n._id)})})]}),e.jsxs("div",{className:"mt-8 justify-end flex items-center gap-4",children:[e.jsx("button",{onClick:()=>g(n=>Math.max(n-1,0)),disabled:s===0,className:"px-4 py-2 border rounded-md text-sm bg-[#1876d2] text-white disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>g(n=>Math.min(n+1,t.length-1)),disabled:s===t.length-1,className:"px-4 py-2 border rounded-md text-sm bg-[#1876d2] text-white disabled:opacity-50",children:"Next"})]})]}),e.jsx("div",{className:"w-full h-full lg:w-1/4 border-t lg:border-t-0 lg:border-l border-gray-200 p-6 bg-white flex flex-col justify-between",children:e.jsxs("div",{className:"w-full h-full flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Question Navigator"}),e.jsx("div",{className:"grid grid-cols-6 gap-2 lg:grid-cols-5",children:t.map((n,d)=>e.jsx("button",{onClick:()=>g(d),className:`${c(n._id)} rounded-full h-[40px] w-[40px]`,children:d+1},n._id))}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Color Legend"}),e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-blue-700 inline-block"}),e.jsx("span",{children:"Current Question"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-green-100 border border-green-400 inline-block"}),e.jsx("span",{children:"Attempted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-orange-100 border border-orange-400 inline-block"}),e.jsx("span",{children:"Seen but Unattempted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-red-100 border border-red-400 inline-block"}),e.jsx("span",{children:"Unseen"})]})]})]})]}),e.jsx($,{onClick:()=>j(!0),variant:"contained",color:"primary",fullWidth:!0,disabled:w,children:"Submit"})]})}),e.jsx(W,{open:f,onClose:()=>j(!1),"aria-labelledby":"submit-confirm-title","aria-describedby":"submit-confirm-description",children:e.jsxs(V,{className:"absolute bg-white p-6 rounded-md shadow-lg",sx:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600},children:[e.jsx(M,{id:"submit-confirm-title",variant:"h6",component:"h2",className:"mb-4",children:"Confirm Submission"}),e.jsx(M,{id:"submit-confirm-description",className:"mb-4 text-sm text-gray-700",children:"Are you sure you want to submit your quiz? You won't be able to change your answers later."}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx($,{onClick:()=>j(!1),variant:"outlined",children:"Cancel"}),e.jsx($,{onClick:m,variant:"contained",color:"primary",children:"Confirm"})]})]})})]})}function ce({setShowOutputWindow:t,codeReview:a,testResults:h,summary:s,isExecuting:g}){const l=(o,b,y=6)=>{const w=b>=1;return e.jsxs("div",{className:`flex justify-between items-center px-4 py-2 rounded text-sm font-medium ${w?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[e.jsx("span",{children:o}),e.jsx("span",{children:w?"Passed":"Failed"})]})};return e.jsx("div",{className:"absolute w-full left-0",children:e.jsxs("div",{className:"bg-white min-h-[calc(100vh-52px-60px)] relative text-black p-6 rounded-3xl shadow-2xl w-[100%] max-w-3xl max-h-[90vh] overflow-y-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Output Window"}),e.jsx(se,{onClick:()=>t(!1),size:"small",children:e.jsx(te,{})})]}),g||h.length==0?e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"h-full w-full flex justify-center pt-5",children:e.jsx("div",{className:"spinner"})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Test Case Results"," ",e.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["(",s==null?void 0:s.passed,"/",parseInt(s==null?void 0:s.passed)+parseInt(s==null?void 0:s.failed)," Passed)"]})]}),h.slice(0,2).map((o,b)=>e.jsxs("div",{className:`border-l-4 p-4 rounded shadow-sm ${o.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," ",e.jsx("pre",{className:"inline",children:o.input})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected:"})," ",e.jsx("pre",{className:"inline",children:o.expected})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Your Output:"})," ",e.jsx("pre",{className:"inline",children:o.output})]}),e.jsxs("p",{className:"mt-1 text-sm font-semibold",children:["Result:"," ",o.passed?e.jsx("span",{className:"text-green-700",children:"✅ Passed"}):e.jsx("span",{className:"text-red-700",children:"❌ Failed"})]}),o.error&&e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["Error: ",o.error]})]},b)),h.length>2&&e.jsx("div",{className:"text-sm text-gray-500 italic",children:"Only first 2 test cases are shown."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"AI Code Review"}),a?e.jsxs("div",{className:"space-y-2",children:[l("Indentation",a.indentation),l("Modularity",a.modularity),l("Variable Naming",a.variable_name_convention),l("Time Complexity",a.time_complexity),l("Space Complexity",a.space_complexity),l("Final",a.finalScore)]}):e.jsx("div",{className:"text-gray-500 text-sm",children:"Code review not available."})]})]})]})})}const P=t=>typeof t=="string"?btoa(unescape(encodeURIComponent(t))):"",B=t=>typeof t=="string"?decodeURIComponent(escape(atob(t))):"",D=async({code:t,language:a,testCases:h,setIsExecuting:s,setSummary:g,setTestResults:l,headers:o,CODE_EXECUTION_API:b,getLanguageId:y})=>{s(!0);const w=[];let u=0,f=0,j=0;try{const r=h.map(d=>({source_code:P(t),language_id:y(a),stdin:P(d.input),cpu_time_limit:5,memory_limit:128e3})),c=(await I.post(`${b}/submissions/batch?base64_encoded=true&wait=false`,{submissions:r},{headers:o})).data||[];(await me(c,b,o)).forEach((d,N)=>{const _=h[N],S=d.stdout,T=_.output.trim(),k=S===T,E=d.stderr||d.compile_error||"";k&&u++,f+=parseFloat(d.time||0),j+=parseInt(d.memory||0),w.push({input:_.input,output:S,expected:T,passed:k,error:E})});const i=f/h.length,n=j/h.length;g({passed:u,failed:h.length-u,total:h.length,avgTime:i.toFixed(3),avgMemory:n.toFixed(2)}),l(w)}catch(r){console.error("Batch execution error:",r)}finally{s(!1)}},me=async(t,a,h)=>{const l=t.map(o=>typeof o=="string"?o:o.token);for(let o=0;o<10;o++)try{const y=(await I.get(`${a}/submissions/batch?tokens=${l.join(",")}&base64_encoded=true`,{headers:h})).data.submissions;if(y.every(u=>{var f;return[3,4,6,11].includes((f=u.status)==null?void 0:f.id)}))return y.map(u=>({stdout:u.stdout?B(u.stdout).trim():"",stderr:u.stderr?B(u.stderr).trim():"",compile_error:u.compile_output?B(u.compile_output).trim():"",time:u.time||"0",memory:u.memory||"0",status:u.status}));await new Promise(u=>setTimeout(u,2e3))}catch(b){return console.error("Batch fetch error:",b),l.map(()=>({stdout:"",stderr:"Failed to fetch result.",compile_error:"",time:"0",memory:"0",status:{id:-1,description:"Fetch error"}}))}return l.map(()=>({stdout:"",stderr:"Timed out.",compile_error:"",time:"0",memory:"0",status:{id:-2,description:"Timed out"}}))};function xe(t){if(!t)return null;const a=t.replace(/```json\n?/,"").replace(/```$/,"");try{return JSON.parse(a)}catch(h){return console.error("Failed to parse cleaned JSON:",h),null}}const U=async({code:t,setCodeReview:a,problemName:h})=>{I.post(`${L}/api/v3/review/code`,{sourceCode:t,problem:h}).then(s=>{const g=xe(s.data.data);return a(g),g}).catch(s=>console.error(s))},Y=t=>({cpp:54,c:50,java:62,python:71})[t]||71;function he({setCurrProblem:t,currProblem:a,submittedProblems:h,problem:s,currSetting:g,setCurrentSection:l,setSubmittedProblems:o,handleCodeChange:b,handleLanguageChange:y}){const{user:w}=A(p=>p.auth),{id:u}=Z(),[f,j]=x.useState(g[a].language),[r,v]=x.useState(g[a].code),[c,m]=x.useState(!1),[i,n]=x.useState(),[d,N]=x.useState([]),[_,S]=x.useState(!1),[T,k]=x.useState(),[E,z]=x.useState(!1);x.useEffect(()=>(h.includes(a)?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[a,h]),x.useEffect(()=>{const p=g[a];j(p.language),v(p.code)},[a,g]);const Q=p=>{v(p),b(a,p)},H=p=>{const C=p.target.value;window.confirm("Changing the language might reset your code. Proceed?")&&(j(C),y(a,C))},K=async()=>{S(!0),N([]),n([]),k(),await D({code:r,language:f,testCases:s.testCases,setIsExecuting:m,setSummary:n,setTestResults:N,headers:O,CODE_EXECUTION_API:F,getLanguageId:Y}),await U({setCodeReview:k,code:r,problemName:s.title})},X=async()=>{S(!0),z(!1),N([]),n([]),k([]);try{await D({code:r,language:f,testCases:s.testCases,setIsExecuting:m,setSummary:n,setTestResults:N,headers:O,CODE_EXECUTION_API:F,getLanguageId:Y}),await U({setCodeReview:k,code:r,problemName:s.title});const p=await I.post(`${L}/api/v3/review/submit`,{userId:w._id,testId:u,problemId:s._id,language:f,sourceCode:r,codeReview:T,passedTestCases:(i==null?void 0:i.passed)||0,totalTestCases:(i==null?void 0:i.total)||0,executionTime:i==null?void 0:i.avgTime,memoryUsed:i==null?void 0:i.avgMemory});o(C=>[...C,{pNo:a,id:p.data.submissionId}])}catch(p){console.error("Submission API error:",p)}};return s?e.jsx(e.Fragment,{children:e.jsxs("section",{className:"p-5  h-[calc(100vh-60px-52px)]  overflow-x-hidden overflow-y-hidden left-0  relative flex w-[calc(100vw-70px)]",children:[e.jsxs("div",{className:"flex-[0.6] relative min-w-[200px] custom-scrollbar overflow-y-hidden",children:[e.jsxs("div",{className:"flex-[0.4] overflow-y-scroll h-full p-4 space-y-4 text-sm",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.title}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Description"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:s.description})]}),s.constraints&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Constraints"}),e.jsx("ul",{className:"list-disc list-inside text-gray-600",children:s.constraints.map((p,C)=>e.jsx("li",{children:p},C))})]}),s.topics&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Topics"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.topics.map((p,C)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:p},C))})]}),s.hints&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Hints"}),e.jsx("ul",{className:"list-disc list-inside text-gray-600",children:s.hints.map((p,C)=>e.jsx("li",{children:p},C))})]}),s.sampleTestCases&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Sample Test Cases"}),s.sampleTestCases.map((p,C)=>e.jsxs("div",{className:"mb-2 p-2 bg-gray-100 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," ",p.input]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Output:"})," ",p.output]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Explanation:"})," ",p.explanation]})]},C))]})]}),e.jsx("div",{className:`absolute w-full h-[] top-0 transition-all duration-300 ease-linear  ${_?"top-0":"top-[100vh] invisible "}`,children:_&&e.jsx(e.Fragment,{children:e.jsx(ce,{codeReview:T,setShowOutputWindow:S,testResults:d,summary:i})})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("hr",{className:"bg-gray-300  flex-1 w-[2px]"}),e.jsxs("div",{className:"hover:bg-blue-500 hover:text-white cursor-grab bg-gray-300 h-[25px] w-[25px] flex items-center  rounded-full",children:[e.jsx(oe,{sx:{marginRight:"-3px"},fontSize:"12"}),e.jsx(ae,{sx:{marginLeft:"-3px"},fontSize:"12"})]}),e.jsx("hr",{className:"bg-gray-300 flex-1 w-[2px]"})]}),e.jsxs("div",{className:"mb-10 relative flex-1",children:[h.some(p=>p.pNo===a)&&e.jsx("div",{className:"absolute h-full w-full inset-0  bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-white text-black p-6 rounded shadow-lg text-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Submission Notice"}),e.jsx("p",{children:"You have already submitted this problem."})]})}),e.jsxs("div",{className:"bg-gray-50 flex justify-between p-5 mx-5 rounded-t-lg",children:[e.jsxs("div",{className:"flex flex-col  ml-1",children:[e.jsx("label",{className:"text-xs mb-1",children:"Choose language"}),e.jsxs("select",{value:f,onChange:H,className:"custominput",children:[e.jsx("option",{value:"cpp",children:"C++"}),e.jsx("option",{value:"c",children:"C"}),e.jsx("option",{value:"java",children:"Java"}),e.jsx("option",{value:"python",children:"Python"})]})]}),e.jsxs("div",{className:"flex justify-end flex-1 items-center gap-2",children:[e.jsx("button",{onClick:K,className:"rounded-md border border-slate-300 py-2 px-4 text-sm transition-all shadow-sm hover:shadow-lg text-white bg-slate-800 disabled:opacity-50",type:"button",disabled:c,children:c?"Running...":"Run Code"}),e.jsx("button",{onClick:()=>z(!0),className:"rounded-md border border-slate-300 py-2 px-4 text-sm transition-all shadow-sm hover:shadow-lg text-white bg-slate-800",type:"button",children:"Submit"})]})]}),e.jsx("div",{className:"bg-gray-50 shadow-lg border mx-5 custom-scrollbar",children:e.jsx(ee,{height:"550px",language:f,value:r,onChange:Q,options:{theme:"light",minimap:{enabled:!1},fontSize:14}})})]}),e.jsx(W,{open:E,onClose:()=>z(!1),"aria-labelledby":"submit-confirm-title","aria-describedby":"submit-confirm-description",children:e.jsxs(V,{className:"absolute bg-white p-6 rounded-md shadow-lg",sx:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600},children:[e.jsx(M,{id:"submit-confirm-title",variant:"h6",component:"h2",className:"mb-4",children:"Confirm Submission"}),e.jsx(M,{id:"submit-confirm-description",className:"mb-4 text-sm text-gray-700",children:"Are you sure you want to submit your code ? You won't be able to change your solution later."}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx($,{onClick:()=>z(!1),variant:"outlined",children:"Cancel"}),e.jsx($,{onClick:X,variant:"contained",color:"primary",children:"Confirm"})]})]})})]})}):e.jsx("p",{className:"p-5 text-red-500",children:"Problem not found"})}function ue({test:t,currSection:a,testSubmission:h}){const[s,g]=x.useState(0),[l,o]=x.useState([]),{user:b}=A(c=>c.auth),[y,w]=x.useState(),[u,f]=x.useState(()=>t.sections[a].problemset.map((c,m)=>{var i;return{id:m,language:"cpp",code:((i=c.functionSignature.find(n=>n.language==="cpp"))==null?void 0:i.signature)||""}}));x.useEffect(()=>{(async()=>{try{const i=(await Promise.all(t==null?void 0:t.sections[a].problemset.map(n=>I.get(`${L}/api/v2/test/get/problem/response`,{params:{userId:b._id,problemId:n._id,testId:t._id},withCredentials:!0})))).map((n,d)=>n.data.exists?{pNo:d,id:n.data.id}:null).filter(n=>n!==null);o(i)}catch(m){console.error("Error fetching submissions:",m)}})()},[a,t._id,b._id,t==null?void 0:t.sections]),x.useEffect(()=>{f(c=>t.sections[a].problemset.map((m,i)=>{var n;return c[i]||{id:i,language:"cpp",code:((n=m.functionSignature.find(d=>d.language==="cpp"))==null?void 0:n.signature)||""}}))},[a,t.sections]);const j=(c,m)=>{f(i=>{const n=[...i];return n[c]={...n[c],code:m},n})},r=(c,m)=>{f(i=>{const n=[...i],d=n[c],N=t.sections[a].problemset[c].functionSignature.find(_=>_.language===m);return n[c]={...d,language:m,code:(N==null?void 0:N.signature)||""},n})},v=async()=>{try{w(!0),await I.post(`${L}/api/v2/test/submit-section/${h._id}`,{sectionId:t.sections[a]._id,sectionType:t.sections[a].sectionType,codingAnswers:l},{withCredentials:!0}),window.location.reload()}catch(c){console.error("Submit error:",c)}finally{w(!1)}};return x.useEffect(()=>{l.length==t.sections[a].problemset.length&&v()},[l]),e.jsxs(e.Fragment,{children:[l.length===t.sections[a].problemset.length&&e.jsx("div",{className:"fixed top-[67px]  flex w-full justify-end pr-24",children:e.jsx($,{disabled:y,onClick:v,variant:"contained",sx:{bgcolor:"#000"},children:y?e.jsx(ie,{size:14}):"Submit"})}),e.jsx("div",{className:"fixed right-0 top-[70px] h-[calc(100vh-70px)] px-5 py-4 bg-gray-50 shadow-sm rounded-md mb-4",children:e.jsxs("div",{className:"relative flex flex-col items-center gap-6",children:[e.jsx("div",{className:"absolute top-0 bottom-0 left-1/2 w-[2px] bg-gray-400 z-0"}),t.sections[a].problemset.map((c,m)=>{const i=l.some(d=>(d==null?void 0:d.pNo)===m),n=m===s;return e.jsx("span",{onClick:()=>{i||g(m)},disabled:i,className:`relative border-gray-300 border-2 z-10 flex justify-center items-center h-[35px] w-[35px] rounded-full text-sm font-medium transition duration-200
            ${i?"bg-blue-500 text-white border-green-600 cursor-not-allowed":n?"bg-blue-500  text-white cursor-pointer shadow-md":"bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 border-gray-300"}
          `,title:i?"Already submitted":"Click to open",children:i?e.jsx(J,{fontSize:"small",className:"text-blue-400"}):m+1},m)})]})}),s<t.sections[a].problemset.length&&e.jsx(he,{setCurrProblem:g,currProblem:s,submittedProblems:l,problem:t.sections[a].problemset[s],currSetting:u,setSubmittedProblems:o,setCurrentSection:f,handleCodeChange:j,handleLanguageChange:r})]})}function Me({userId:t,testSubmission:a,testId:h,currSection:s,setCurrentSection:g,test:l}){var j;const[o,b]=x.useState(0),{user:y}=A(r=>r.auth),[w,u]=x.useState(!1);x.useEffect(()=>{if(l&&a){const v=new Date(a.startedAt).getTime()+l.duration*60*1e3,c=setInterval(()=>{const m=v-Date.now();b(Math.max(m,0)),m<=0&&(clearInterval(c),f())},1e3);return()=>clearInterval(c)}},[a,l]);const f=()=>{console.log("Time's up! Submitting test...")};return a.isSubmitted?e.jsx(e.Fragment,{children:e.jsx(pe,{testSubmission:a})}):e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"flex gap-8 relative h-[60px] items-center left-0 shadow-sm w-full p-4",children:e.jsxs("nav",{className:"flex gap-8 fixed h-[60px] z-20 justify-between bg-white left-0 top-0 items-center shadow-sm w-full p-4",children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsx("img",{src:q,className:"h-9",alt:"Logo"})}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("p",{children:"Time left"}),o>0?e.jsxs("div",{className:"flex gap-4 items-center px-3 p-1 bg-gray-300 text-gray-900 rounded-sm shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 text-md ",children:[e.jsx("span",{className:"text-lg animate-pulse"}),Math.floor(o/6e4)," m"]}),e.jsx(le,{orientation:"vertical",flexItem:!0,className:"border-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2 text-md ",children:[e.jsx("span",{className:"text-lg animate-pulse",children:" "}),Math.floor(o%6e4/1e3)," s"]})]}):e.jsx("span",{className:"text-red-500 font-bold",children:"Loading...."}),e.jsx("div",{className:"cursor-pointer",children:e.jsx(re,{})})]})]})}),e.jsx("div",{className:"flex px-3 py-2 shadow-sm bg-gray-50 items-center gap-2",children:l==null?void 0:l.sections.map((r,v)=>{const c=v===s,m=v<s,i=v>s;return e.jsxs("div",{className:`w-[140px] py-2 px-3 rounded-lg shadow-sm text-sm flex justify-between items-center cursor-pointer transition duration-300
    ${c?"bg-blue-600 text-white":"bg-white hover:bg-blue-50 text-blue-800"}
  `,children:[e.jsx("span",{className:"mr-2 font-medium truncate",children:r.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[m&&e.jsx(J,{fontSize:"small",className:"text-blue-400"}),i&&e.jsx(ne,{fontSize:"small",className:"text-blue-200"})]})]},v)})}),l.sections[s].sectionType=="Quiz"?e.jsx(de,{testSubmissionId:a._id,sectionId:l.sections[s]._id,questionSet:(j=l.sections[s])==null?void 0:j.questionSet}):e.jsx(ue,{testSubmission:a,currSection:s,test:l})]})}function pe({testSubmission:t}){return t!=null&&t.isSubmitted?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-8 max-w-xl w-full text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-green-700 mb-4",children:"Test Submitted Successfully"}),e.jsxs("p",{className:"text-gray-700 text-base mb-6",children:["Your test response has been successfully recorded. ",e.jsx("br",{}),"You may review your answers in the ",e.jsx("span",{className:"font-medium text-blue-600",children:"Preview"})," section."]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(R,{to:"/",children:e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-md text-sm transition-all",children:"Return to Home"})}),e.jsx(R,{to:"/user",children:e.jsx("button",{className:"bg-gray-200 hover:bg-gray-300 text-gray-800 px-5 py-2 rounded-md text-sm transition-all",children:"View Response"})})]})]})}):null}export{Me as default};
