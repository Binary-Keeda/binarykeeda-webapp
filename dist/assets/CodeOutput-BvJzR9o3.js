import{r as l,c as A,e as G,j as e,a as N,B as J,C as L,n as U}from"./index-ByscKdnN.js";import{I as W}from"./IconButton-DUhFuVRf.js";import{C as z}from"./Close-TIsiLFFR.js";import"./CircularProgress-CGXYK_QQ.js";import"./createSvgIcon-CV4kloV_.js";const se=({setShowSubmitWindow:v,setSubmittedProblems:D,problemName:w,code:m,currProblem:V,testCases:d,language:C,fetchResult:S,problemId:X,getLanguageId:_})=>{const[a,E]=l.useState(null),[R,u]=l.useState(!1),[I,p]=l.useState(!1),[x,O]=l.useState([]),[P,F]=l.useState({passed:0,failed:0}),{user:Y}=A(s=>s.auth),{id:q}=G(),T=async()=>{var h,f;p(!0);const s=[];let t=0,o=0,c=0;for(const i of d)try{const M=(await N.post(`${L}/submissions?base64_encoded=false`,{source_code:m,language_id:_(C),stdin:i.input,cpu_time_limit:5,memory_limit:128e3},{headers:U})).data.token,n=await S(M),g=((h=n==null?void 0:n.stdout)==null?void 0:h.trim())||"",y=i.output.trim(),b=g===y,B=((f=n.stderr)==null?void 0:f.trim())||null;b&&t++,o+=parseFloat(n.time||0),c+=parseInt(n.memory||0),s.push({input:i.input,output:g,expected:y,passed:b,error:B})}catch(j){console.error("Test case error:",j),s.push({input:i.input,output:"",expected:i.output,passed:!1,error:"Execution failed"})}F({passed:t,failed:d.length-t}),O(s),p(!1)},$=()=>{u(!0),N.post(`${J}/api/v3/review/code`,{sourceCode:m,problem:w}).then(s=>{const t=k(s.data.data);E(t)}).catch(s=>console.error(s)).finally(()=>u(!1))};function k(s){if(!s)return null;const t=s.replace(/```json\n?/,"").replace(/```$/,"");try{return JSON.parse(t)}catch(o){return console.error("Failed to parse cleaned JSON:",o),null}}l.useEffect(()=>{a?T():$()},[a]);const r=(s,t,o=6)=>{const c=t>=1;return e.jsxs("div",{className:`flex justify-between items-center px-4 py-2 rounded text-sm font-medium ${c?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[e.jsx("span",{children:s}),e.jsx("span",{children:c?"Passed":"Failed"})]})};return e.jsx("div",{className:"absolute w-full left-0",children:e.jsxs("div",{className:"bg-white min-h-[calc(100vh-52px-60px)] relative text-black p-6 rounded-3xl shadow-2xl w-[100%] max-w-3xl max-h-[90vh] overflow-y-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Output Window"}),e.jsx(W,{onClick:()=>v(!1),size:"small",children:e.jsx(z,{})})]}),R||I?e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"loader3"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Test Case Results"," ",e.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["(",P.passed,"/",d.length," Passed)"]})]}),x.slice(0,2).map((s,t)=>e.jsxs("div",{className:`border-l-4 p-4 rounded shadow-sm ${s.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," ",e.jsx("pre",{className:"inline",children:s.input})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected:"})," ",e.jsx("pre",{className:"inline",children:s.expected})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Your Output:"})," ",e.jsx("pre",{className:"inline",children:s.output})]}),e.jsxs("p",{className:"mt-1 text-sm font-semibold",children:["Result:"," ",s.passed?e.jsx("span",{className:"text-green-700",children:"✅ Passed"}):e.jsx("span",{className:"text-red-700",children:"❌ Failed"})]}),s.error&&e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["Error: ",s.error]})]},t)),x.length>2&&e.jsx("div",{className:"text-sm text-gray-500 italic",children:"Only first 2 test cases are shown."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Code Review"}),a?e.jsxs("div",{className:"space-y-2",children:[r("Indentation",a.indentation),r("Modularity",a.modularity),r("Variable Naming",a.variable_name_convention),r("Time Complexity",a.time_complexity),r("Space Complexity",a.space_complexity),r("Final",a.finalScore)]}):e.jsx("div",{className:"text-gray-500 text-sm",children:"Code review not available."})]})]})]})})};export{se as default};
