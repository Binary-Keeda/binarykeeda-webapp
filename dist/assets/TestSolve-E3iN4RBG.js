import{j as e,r as u,a as k,B as z,c as A,e as q,C as O,p as R,f as ee,L as D}from"./index-DnV67Q7k.js";import{B as $}from"./Button-C8dXO8WU.js";import{M as Q}from"./Modal-wHAvyv_C.js";import{B as V}from"./Box-DeSc4YZo.js";import{T as E}from"./Typography-DOFhr2Cr.js";import{d as se}from"./index-DE4kXtZ7.js";import{I as te}from"./IconButton-CAYuThCE.js";import{C as ae}from"./Close-BbtwARFK.js";import{c as F}from"./createSvgIcon-BDpEZ6gR.js";import{C as ne}from"./CircularProgress-DvQFBg1F.js";import{D as ie}from"./Divider-BCT_Doe6.js";import{S as le}from"./ShortText-BTDmcNLo.js";import{L as re}from"./Lock-DTNjSmcL.js";import"./DefaultPropsProvider-DZgXFkFn.js";import"./createSimplePaletteValueFilter-DtyoeLUc.js";import"./ButtonBase-gaihx2Xk.js";import"./useForkRef-BGyVH2of.js";import"./Portal-BmOUefV8.js";import"./useSlot-DNFgS7sg.js";import"./index-BbVhOFfz.js";import"./index-zysyRxOi.js";import"./dividerClasses-C-n-tsxu.js";const G=F(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),oe=F(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),de=F(e.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");function ce({questionSet:t=[],sectionId:a,testSubmissionId:l}){var h;const[n,r]=u.useState(0),[i,d]=u.useState({}),[j,y]=u.useState(new Set),[N,p]=u.useState(!1),[v,f]=u.useState(!1),c=t[n];u.useEffect(()=>{c!=null&&c._id&&y(s=>new Set(s).add(c._id))},[n,c]);const b=(s,o)=>{d(C=>({...C,[s]:o}))},m=s=>{var T;const o=((T=t[n])==null?void 0:T._id)===s,C=i[s],S=j.has(s);let _="p-2 border text-sm";return o?`${_} bg-blue-700 text-white border-blue-700`:C?`${_} bg-green-100 border-green-400 text-green-800`:S?`${_} bg-orange-100 border-orange-400 text-orange-800`:`${_} bg-red-100 border-red-400 text-red-800`},x=()=>{f(!1),p(!0),k.post(`${z}/api/v2/test/submit-section/${l}`,{sectionId:a,sectionType:"Quiz",quizAnswers:i},{withCredentials:!0}).then(()=>{f(!1),window.location.reload()}).catch(s=>{console.log(s),p(!1)})};return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-52px-70px)] lg:flex-row font-sans bg-white text-gray-800",children:[e.jsxs("div",{className:"flex-1 flex-col justify-between flex h-full p-5",children:[e.jsxs("div",{className:"border w-full border-gray-200 rounded-sm p-8 shadow-sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-2",children:["Question ",n+1," of ",t.length]}),e.jsx("p",{className:"text-base",children:c==null?void 0:c.question})]}),e.jsx("div",{className:"space-y-4",children:(h=c==null?void 0:c.answerOptions)==null?void 0:h.map(s=>{const o=i[c._id]==s._id;return e.jsxs("label",{className:`flex items-center border p-3 rounded-md cursor-pointer transition ${o?"border-blue-600 bg-blue-50":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",className:"mr-3",name:`question-${c._id}`,value:s._id,checked:o,onChange:()=>b(c._id,s._id)}),e.jsx("span",{className:"text-sm",children:s.text})]},s._id)})})]}),e.jsxs("div",{className:"mt-8 justify-end flex items-center gap-4",children:[e.jsx("button",{onClick:()=>r(s=>Math.max(s-1,0)),disabled:n===0,className:"px-4 py-2 border rounded-md text-sm bg-[#1876d2] text-white disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>r(s=>Math.min(s+1,t.length-1)),disabled:n===t.length-1,className:"px-4 py-2 border rounded-md text-sm bg-[#1876d2] text-white disabled:opacity-50",children:"Next"})]})]}),e.jsx("div",{className:"w-full h-full lg:w-1/4 border-t lg:border-t-0 lg:border-l border-gray-200 p-6 bg-white flex flex-col justify-between",children:e.jsxs("div",{className:"w-full h-full flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Question Navigator"}),e.jsx("div",{className:"grid grid-cols-6 gap-2 lg:grid-cols-5",children:t.map((s,o)=>e.jsx("button",{onClick:()=>r(o),className:`${m(s._id)} rounded-full h-[40px] w-[40px]`,children:o+1},s._id))}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Color Legend"}),e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-blue-700 inline-block"}),e.jsx("span",{children:"Current Question"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-green-100 border border-green-400 inline-block"}),e.jsx("span",{children:"Attempted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-orange-100 border border-orange-400 inline-block"}),e.jsx("span",{children:"Seen but Unattempted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-sm bg-red-100 border border-red-400 inline-block"}),e.jsx("span",{children:"Unseen"})]})]})]})]}),e.jsx($,{onClick:()=>f(!0),variant:"contained",color:"primary",fullWidth:!0,disabled:N,children:"Submit"})]})}),e.jsx(Q,{open:v,onClose:()=>f(!1),"aria-labelledby":"submit-confirm-title","aria-describedby":"submit-confirm-description",children:e.jsxs(V,{className:"absolute bg-white p-6 rounded-md shadow-lg",sx:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600},children:[e.jsx(E,{id:"submit-confirm-title",variant:"h6",component:"h2",className:"mb-4",children:"Confirm Submission"}),e.jsx(E,{id:"submit-confirm-description",className:"mb-4 text-sm text-gray-700",children:"Are you sure you want to submit your quiz? You won't be able to change your answers later."}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx($,{onClick:()=>f(!1),variant:"outlined",children:"Cancel"}),e.jsx($,{onClick:x,variant:"contained",color:"primary",children:"Confirm"})]})]})})]})}function me({setShowOutputWindow:t,codeReview:a,testResults:l,summary:n,isExecuting:r}){const i=(d,j,y=6)=>{const N=j>=1;return e.jsxs("div",{className:`flex justify-between items-center px-4 py-2 rounded text-sm font-medium ${N?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[e.jsx("span",{children:d}),e.jsx("span",{children:N?"Passed":"Failed"})]})};return e.jsx("div",{className:"absolute w-full left-0",children:e.jsxs("div",{className:"bg-white min-h-[calc(100vh-52px-60px)] relative text-black p-6 rounded-3xl shadow-2xl w-[100%] max-w-3xl max-h-[90vh] overflow-y-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Output Window"}),e.jsx(te,{onClick:()=>t(!1),size:"small",children:e.jsx(ae,{})})]}),r||l.length==0?e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"h-full w-full flex justify-center pt-5",children:e.jsx("div",{className:"spinner"})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Test Case Results"," ",e.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["(",n==null?void 0:n.passed,"/",parseInt(n==null?void 0:n.passed)+parseInt(n==null?void 0:n.failed)," Passed)"]})]}),l.slice(0,2).map((d,j)=>e.jsxs("div",{className:`border-l-4 p-4 rounded shadow-sm ${d.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," ",e.jsx("pre",{className:"inline",children:d.input})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected:"})," ",e.jsx("pre",{className:"inline",children:d.expected})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Your Output:"})," ",e.jsx("pre",{className:"inline",children:d.output})]}),e.jsxs("p",{className:"mt-1 text-sm font-semibold",children:["Result:"," ",d.passed?e.jsx("span",{className:"text-green-700",children:"✅ Passed"}):e.jsx("span",{className:"text-red-700",children:"❌ Failed"})]}),d.error&&e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["Error: ",d.error]})]},j)),l.length>2&&e.jsx("div",{className:"text-sm text-gray-500 italic",children:"Only first 2 test cases are shown."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"AI Code Review"}),a?e.jsxs("div",{className:"space-y-2",children:[i("Indentation",a.indentation),i("Modularity",a.modularity),i("Variable Naming",a.variable_name_convention),i("Time Complexity",a.time_complexity),i("Space Complexity",a.space_complexity),i("Final",a.finalScore)]}):e.jsx("div",{className:"text-gray-500 text-sm",children:"Code review not available."})]})]})]})})}const P=t=>typeof t=="string"?btoa(unescape(encodeURIComponent(t))):"",B=t=>typeof t=="string"?decodeURIComponent(escape(atob(t))):"",U=async({code:t,language:a,testCases:l,setIsExecuting:n,setSummary:r,setTestResults:i,headers:d,CODE_EXECUTION_API:j,getLanguageId:y})=>{n(!0);const N=[];let p=0,v=0,f=0;try{const c=l.map(o=>({source_code:P(t),language_id:y(a),stdin:P(o.input),cpu_time_limit:5,memory_limit:128e3})),m=(await k.post(`${j}/submissions/batch?base64_encoded=true&wait=false`,{submissions:c},{headers:d})).data||[];(await xe(m,j,d)).forEach((o,C)=>{const S=l[C],_=o.stdout,T=S.output.trim(),L=_===T,I=o.stderr||o.compile_error||"";L&&p++,v+=parseFloat(o.time||0),f+=parseInt(o.memory||0),N.push({input:S.input,output:_,expected:T,passed:L,error:I})});const h=v/l.length,s=f/l.length;r({passed:p,failed:l.length-p,total:l.length,avgTime:h.toFixed(3),avgMemory:s.toFixed(2)}),i(N)}catch(c){console.error("Batch execution error:",c)}finally{n(!1)}},xe=async(t,a,l)=>{const i=t.map(d=>typeof d=="string"?d:d.token);for(let d=0;d<10;d++)try{const y=(await k.get(`${a}/submissions/batch?tokens=${i.join(",")}&base64_encoded=true`,{headers:l})).data.submissions;if(y.every(p=>{var v;return[3,4,6,11].includes((v=p.status)==null?void 0:v.id)}))return y.map(p=>({stdout:p.stdout?B(p.stdout).trim():"",stderr:p.stderr?B(p.stderr).trim():"",compile_error:p.compile_output?B(p.compile_output).trim():"",time:p.time||"0",memory:p.memory||"0",status:p.status}));await new Promise(p=>setTimeout(p,2e3))}catch(j){return console.error("Batch fetch error:",j),i.map(()=>({stdout:"",stderr:"Failed to fetch result.",compile_error:"",time:"0",memory:"0",status:{id:-1,description:"Fetch error"}}))}return i.map(()=>({stdout:"",stderr:"Timed out.",compile_error:"",time:"0",memory:"0",status:{id:-2,description:"Timed out"}}))};function he(t){if(!t)return null;const a=t.replace(/```json\n?/,"").replace(/```$/,"");try{return JSON.parse(a)}catch(l){return console.error("Failed to parse cleaned JSON:",l),null}}const Y=async({code:t,setCodeReview:a,problemName:l})=>{k.post(`${z}/api/v3/review/code`,{sourceCode:t,problem:l}).then(n=>{const r=he(n.data.data);return a(r),r}).catch(n=>console.error(n))},W=t=>({cpp:54,c:50,java:62,python:71})[t]||71;function ue({setCurrProblem:t,totalQuestion:a,currProblem:l,submittedProblems:n,problem:r,currSetting:i,setCurrentSection:d,setSubmittedProblems:j,handleCodeChange:y,handleLanguageChange:N}){const{user:p}=A(g=>g.auth),{id:v}=q(),[f,c]=u.useState(i[l].language),[b,m]=u.useState(i[l].code),[x,h]=u.useState(!1),[s,o]=u.useState(),[C,S]=u.useState([]),[_,T]=u.useState(!1),[L,I]=u.useState(),[J,M]=u.useState(!1);u.useEffect(()=>(n.includes(l)?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[l,n]),u.useEffect(()=>{const g=i[l];c(g.language),m(g.code)},[l,i]);const H=g=>{m(g),y(l,g)},K=g=>{const w=g.target.value;window.confirm("Changing the language might reset your code. Proceed?")&&(c(w),N(l,w))},X=async()=>{T(!0),S([]),o([]),I(),await U({code:b,language:f,testCases:r.testCases,setIsExecuting:h,setSummary:o,setTestResults:S,headers:R,CODE_EXECUTION_API:O,getLanguageId:W}),await Y({setCodeReview:I,code:b,problemName:r.title})},Z=async()=>{T(!0),M(!1),S([]),o([]),I([]);try{await U({code:b,language:f,testCases:r.testCases,setIsExecuting:h,setSummary:o,setTestResults:S,headers:R,CODE_EXECUTION_API:O,getLanguageId:W}),await Y({setCodeReview:I,code:b,problemName:r.title});const g=await k.post(`${z}/api/v3/review/submit`,{userId:p._id,testId:v,problemId:r._id,language:f,sourceCode:b,codeReview:L,passedTestCases:(s==null?void 0:s.passed)||0,totalTestCases:(s==null?void 0:s.total)||0,executionTime:s==null?void 0:s.avgTime,memoryUsed:s==null?void 0:s.avgMemory});j(w=>[...w,{pNo:l,id:g.data.submissionId}]),setTimeout(()=>{T(!1),t(w=>(w+1)%a)},3e3)}catch(g){console.error("Submission API error:",g)}};return r?e.jsx(e.Fragment,{children:e.jsxs("section",{className:"p-5  h-[calc(100vh-60px-52px)]  overflow-x-hidden overflow-y-hidden left-0  relative flex w-[calc(100vw-70px)]",children:[e.jsxs("div",{className:"flex-[0.6] relative min-w-[200px] custom-scrollbar overflow-y-hidden",children:[e.jsxs("div",{className:"flex-[0.4] overflow-y-scroll h-full p-4 space-y-4 text-sm",children:[e.jsx("h1",{className:"text-2xl font-bold",children:r.title}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Description"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:r.description})]}),r.constraints&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Constraints"}),e.jsx("ul",{className:"list-disc list-inside text-gray-600",children:r.constraints.map((g,w)=>e.jsx("li",{children:g},w))})]}),r.topics&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Topics"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.topics.map((g,w)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:g},w))})]}),r.hints&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Hints"}),e.jsx("ul",{className:"list-disc list-inside text-gray-600",children:r.hints.map((g,w)=>e.jsx("li",{children:g},w))})]}),r.sampleTestCases&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Sample Test Cases"}),r.sampleTestCases.map((g,w)=>e.jsxs("div",{className:"mb-2 p-2 bg-gray-100 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," ",g.input]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Output:"})," ",g.output]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Explanation:"})," ",g.explanation]})]},w))]})]}),e.jsx("div",{className:`absolute w-full h-[] top-0 transition-all duration-300 ease-linear  ${_?"top-0":"top-[100vh] invisible "}`,children:_&&e.jsx(e.Fragment,{children:e.jsx(me,{codeReview:L,setShowOutputWindow:T,testResults:C,summary:s})})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("hr",{className:"bg-gray-300  flex-1 w-[2px]"}),e.jsxs("div",{className:"hover:bg-blue-500 hover:text-white cursor-grab bg-gray-300 h-[25px] w-[25px] flex items-center  rounded-full",children:[e.jsx(oe,{sx:{marginRight:"-3px"},fontSize:"12"}),e.jsx(de,{sx:{marginLeft:"-3px"},fontSize:"12"})]}),e.jsx("hr",{className:"bg-gray-300 flex-1 w-[2px]"})]}),e.jsxs("div",{className:"mb-10 relative flex-1",children:[n.some(g=>g.pNo===l)&&e.jsx("div",{className:"absolute h-full w-full inset-0  bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-white text-black p-6 rounded shadow-lg text-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Submission Notice"}),e.jsx("p",{children:"You have already submitted this problem."})]})}),e.jsxs("div",{className:"bg-gray-50 flex justify-between p-5 mx-5 rounded-t-lg",children:[e.jsxs("div",{className:"flex flex-col  ml-1",children:[e.jsx("label",{className:"text-xs mb-1",children:"Choose language"}),e.jsxs("select",{value:f,onChange:K,className:"custominput",children:[e.jsx("option",{value:"cpp",children:"C++"}),e.jsx("option",{value:"c",children:"C"}),e.jsx("option",{value:"java",children:"Java"}),e.jsx("option",{value:"python",children:"Python"})]})]}),e.jsxs("div",{className:"flex justify-end flex-1 items-center gap-2",children:[e.jsx("button",{onClick:X,className:"rounded-md border border-slate-300 py-2 px-4 text-sm transition-all shadow-sm hover:shadow-lg text-white bg-slate-800 disabled:opacity-50",type:"button",disabled:x,children:x?"Running...":"Run Code"}),e.jsx("button",{onClick:()=>M(!0),className:"rounded-md border border-slate-300 py-2 px-4 text-sm transition-all shadow-sm hover:shadow-lg text-white bg-slate-800",type:"button",children:"Submit"})]})]}),e.jsx("div",{className:"bg-gray-50 shadow-lg border mx-5 custom-scrollbar",children:e.jsx(se,{height:"550px",language:f,value:b,onChange:H,options:{theme:"light",minimap:{enabled:!1},fontSize:14}})})]}),e.jsx(Q,{open:J,onClose:()=>M(!1),"aria-labelledby":"submit-confirm-title","aria-describedby":"submit-confirm-description",children:e.jsxs(V,{className:"absolute bg-white p-6 rounded-md shadow-lg",sx:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600},children:[e.jsx(E,{id:"submit-confirm-title",variant:"h6",component:"h2",className:"mb-4",children:"Confirm Submission"}),e.jsx(E,{id:"submit-confirm-description",className:"mb-4 text-sm text-gray-700",children:"Are you sure you want to submit your code ? You won't be able to change your solution later."}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx($,{onClick:()=>M(!1),variant:"outlined",children:"Cancel"}),e.jsx($,{onClick:Z,variant:"contained",color:"primary",children:"Confirm"})]})]})})]})}):e.jsx("p",{className:"p-5 text-red-500",children:"Problem not found"})}function pe({test:t,currSection:a,testSubmission:l}){const[n,r]=u.useState(0),[i,d]=u.useState([]),{user:j}=A(m=>m.auth),[y,N]=u.useState(),[p,v]=u.useState(()=>t.sections[a].problemset.map((m,x)=>{var h;return{id:x,language:"cpp",code:((h=m.functionSignature.find(s=>s.language==="cpp"))==null?void 0:h.signature)||""}}));u.useEffect(()=>{(async()=>{try{const h=(await Promise.all(t==null?void 0:t.sections[a].problemset.map(s=>k.get(`${z}/api/v2/test/get/problem/response`,{params:{userId:j._id,problemId:s._id,testId:t._id},withCredentials:!0})))).map((s,o)=>s.data.exists?{pNo:o,id:s.data.id}:null).filter(s=>s!==null);d(h)}catch(x){console.error("Error fetching submissions:",x)}})()},[a,t._id,j._id,t==null?void 0:t.sections]),u.useEffect(()=>{v(m=>t.sections[a].problemset.map((x,h)=>{var s;return m[h]||{id:h,language:"cpp",code:((s=x.functionSignature.find(o=>o.language==="cpp"))==null?void 0:s.signature)||""}}))},[a,t.sections]);const f=(m,x)=>{v(h=>{const s=[...h];return s[m]={...s[m],code:x},s})},c=(m,x)=>{v(h=>{const s=[...h],o=s[m],C=t.sections[a].problemset[m].functionSignature.find(S=>S.language===x);return s[m]={...o,language:x,code:(C==null?void 0:C.signature)||""},s})},b=async()=>{try{N(!0),await k.post(`${z}/api/v2/test/submit-section/${l._id}`,{sectionId:t.sections[a]._id,sectionType:t.sections[a].sectionType,codingAnswers:i},{withCredentials:!0}),window.location.reload()}catch(m){console.error("Submit error:",m)}finally{N(!1)}};return u.useEffect(()=>{i.length==t.sections[a].problemset.length&&b()},[i]),e.jsxs(e.Fragment,{children:[i.length===t.sections[a].problemset.length&&e.jsx("div",{className:"fixed top-[67px]  flex w-full justify-end pr-24",children:e.jsx($,{disabled:y,onClick:b,variant:"contained",sx:{bgcolor:"#000"},children:y?e.jsx(ne,{size:14}):"Submit"})}),e.jsx("div",{className:"fixed right-0 top-[70px] h-[calc(100vh-70px)] px-5 py-4 bg-gray-50 shadow-sm rounded-md mb-4",children:e.jsxs("div",{className:"relative flex flex-col items-center gap-6",children:[e.jsx("div",{className:"absolute top-0 bottom-0 left-1/2 w-[2px] bg-gray-400 z-0"}),t.sections[a].problemset.map((m,x)=>{const h=i.some(o=>(o==null?void 0:o.pNo)===x),s=x===n;return e.jsx("span",{onClick:()=>{h||r(x)},disabled:h,className:`relative border-gray-300 border-2 z-10 flex justify-center items-center h-[35px] w-[35px] rounded-full text-sm font-medium transition duration-200
            ${h?"bg-blue-500 text-white border-green-600 cursor-not-allowed":s?"bg-blue-500  text-white cursor-pointer shadow-md":"bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 border-gray-300"}
          `,title:h?"Already submitted":"Click to open",children:h?e.jsx(G,{fontSize:"small",className:"text-blue-400"}):x+1},x)})]})}),n<t.sections[a].problemset.length&&e.jsx(ue,{totalQuestion:t.sections[a].problemset.length,setCurrProblem:r,currProblem:n,submittedProblems:i,problem:t.sections[a].problemset[n],currSetting:p,setSubmittedProblems:d,setCurrentSection:v,handleCodeChange:f,handleLanguageChange:c})]})}function De({userId:t,testSubmission:a,testId:l,currSection:n,setCurrentSection:r,test:i}){var f;const[d,j]=u.useState(0),{user:y}=A(c=>c.auth),[N,p]=u.useState(!1);u.useEffect(()=>{if(i&&a){const b=new Date(a.startedAt).getTime()+i.duration*60*1e3,m=setInterval(()=>{const x=b-Date.now();j(Math.max(x,0)),x<=0&&(clearInterval(m),v())},1e3);return()=>clearInterval(m)}},[a,i]);const v=()=>{console.log("Time's up! Submitting test...")};return a.isSubmitted?e.jsx(e.Fragment,{children:e.jsx(ge,{testSubmission:a})}):e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"flex gap-8 relative h-[60px] items-center left-0 shadow-sm w-full p-4",children:e.jsxs("nav",{className:"flex gap-8 fixed h-[60px] z-20 justify-between bg-white left-0 top-0 items-center shadow-sm w-full p-4",children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsx("img",{src:ee,className:"h-9",alt:"Logo"})}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("p",{children:"Time left"}),d>0?e.jsxs("div",{className:"flex gap-4 items-center px-3 p-1 bg-gray-300 text-gray-900 rounded-sm shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 text-md ",children:[e.jsx("span",{className:"text-lg animate-pulse"}),Math.floor(d/6e4)," m"]}),e.jsx(ie,{orientation:"vertical",flexItem:!0,className:"border-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2 text-md ",children:[e.jsx("span",{className:"text-lg animate-pulse",children:" "}),Math.floor(d%6e4/1e3)," s"]})]}):e.jsx("span",{className:"text-red-500 font-bold",children:"Loading...."}),e.jsx("div",{className:"cursor-pointer",children:e.jsx(le,{})})]})]})}),e.jsx("div",{className:"flex px-3 py-2 shadow-sm bg-gray-50 items-center gap-2",children:i==null?void 0:i.sections.map((c,b)=>{const m=b===n,x=b<n,h=b>n;return e.jsxs("div",{className:`w-[140px] py-2 px-3 rounded-lg shadow-sm text-sm flex justify-between items-center cursor-pointer transition duration-300
    ${m?"bg-blue-600 text-white":"bg-white hover:bg-blue-50 text-blue-800"}
  `,children:[e.jsx("span",{className:"mr-2 font-medium truncate",children:c.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[x&&e.jsx(G,{fontSize:"small",className:"text-blue-400"}),h&&e.jsx(re,{fontSize:"small",className:"text-blue-200"})]})]},b)})}),i.sections[n].sectionType=="Quiz"?e.jsx(ce,{testSubmissionId:a._id,sectionId:i.sections[n]._id,questionSet:(f=i.sections[n])==null?void 0:f.questionSet}):e.jsx(pe,{testSubmission:a,currSection:n,test:i})]})}function ge({testSubmission:t}){return t!=null&&t.isSubmitted?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-8 max-w-xl w-full text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-green-700 mb-4",children:"Test Submitted Successfully"}),e.jsxs("p",{className:"text-gray-700 text-base mb-6",children:["Your test response has been successfully recorded. ",e.jsx("br",{}),"You may review your answers in the ",e.jsx("span",{className:"font-medium text-blue-600",children:"Preview"})," section."]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(D,{to:"/",children:e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-md text-sm transition-all",children:"Return to Home"})}),e.jsx(D,{to:"/user",children:e.jsx("button",{className:"bg-gray-200 hover:bg-gray-300 text-gray-800 px-5 py-2 rounded-md text-sm transition-all",children:"View Response"})})]})]})}):null}export{De as default};
